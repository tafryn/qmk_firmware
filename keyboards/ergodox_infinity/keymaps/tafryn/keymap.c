#include QMK_KEYBOARD_H
#include "tafryn.h"
#include "visualizer.h"

// clang-format off
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
/* Keymap 0: Basic QWERTY layer
 *
 * ,---------------------------------------------.           ,---------------------------------------------.
 * |  Esc   |  1  |  2  |  3  |  4  |  5  |  `   |           |  -   |  6  |  7  |  8  |  9  |  0  |   =    |
 * |--------+-----+-----+-----+-----+------------|           |------+-----+-----+-----+-----+-----+--------|
 * |  Tab   |  Q  |  W  |  E  |  R  |  T  | Del  |           | NUM  |  Y  |  U  |  I  |  O  |  P  |  BSPC  |
 * |--------+-----+-----+-----+-----+-----|      |           |      |-----+-----+-----+-----+-----+--------|
 * |  Ctrl  |  A  |  S  |  D  |  F  |  G  |------|           |------|  H  |  J  |  K  |  L  |  ;  |   '    |
 * |--------+-----+-----+-----+-----+-----|  [{  |           |  ]}  |-----+-----+-----+-----+-----+--------|
 * | LShift |  Z  |  X  |  C  |  V  |  B  |      |           |      |  N  |  M  |  ,  |  .  |  /  | RShift |
 * `--------+-----+-----+-----+-----+------------'           `------------+-----+-----+-----+-----+--------'
 *   |OSM_C |OSM_A|Left |Right|LOWER|                                     |RAISE|Down | Up  | Alt | Ctrl |
 *   `------------------------------'                                     `------------------------------'
 *                                   ,-----------.           ,-----------.
 *                                   |Home | End |           |PgDn |PgUp |
 *                             ,-----|-----|-----|           |-----+-----+-----.
 *                             |     |     |Lock |           |A_OFF|     |     |
 *                             |BkSpc|LGUI |-----|           |-----|Enter|Space|
 *                             |     |     |RAISE|           |LOWER|     |     |
 *                             `-----------------'           `-----------------'
 */
[_QWERTY] = LAYOUT_ergodox_pretty_wrapper(
  KC_ESC,   ________________NUMBER_L__________________, KC_GRV, KC_MINS,  ________________NUMBER_R__________________, KC_EQUAL,
  KC_TAB,   ________________QWERTY_L1_________________, KC_DEL, TG(_NUM), ________________QWERTY_R1_________________, KC_BSPACE,
  KC_LCTL,  ________________QWERTY_L2_________________,                   ________________QWERTY_R2_________________, KC_QUOTE,
  KC_LSFT,  ________________QWERTY_L3_________________, KC_LBRC, KC_RBRC, ________________QWERTY_R3_________________, KC_RSFT,
  ________________DOX_L4____________________,                                      ________________DOX_R4____________________,
                                            ________________DOXTHUMBS_________________
),

/* Keymap 1: Basic Dvorak layer
 *
 * ,---------------------------------------------.           ,--------------------------------------------.
 * |  Esc   |  1  |  2  |  3  |  4  |  5  |  `   |           |  =   |  6  |  7  |  8  |  9  |  0  |   \    |
 * |--------+-----+-----+-----+-----+------------|           |------+-----+-----+-----+-----+-----+--------|
 * |  Tab   |  '  |  ,  |  .  |  P  |  Y  | Del  |           | NUM  |  F  |  G  |  C  |  R  |  L  |   /    |
 * |--------+-----+-----+-----+-----+-----|      |           |      |-----+-----+-----+-----+-----+--------|
 * |  Ctrl  |  A  |  O  |  E  |  U  |  I  |------|           |------|  D  |  H  |  T  |  N  |  S  |   -    |
 * |--------+-----+-----+-----+-----+-----|  [{  |           |  ]}  |-----+-----+-----+-----+-----+--------|
 * | LShift |  ;  |  Q  |  J  |  K  |  X  |      |           |      |  B  |  M  |  W  |  V  |  Z  | RShift |
 * `--------+-----+-----+-----+-----+------------'           `------------+-----+-----+-----+-----+--------'
 *   |OSM_C |OSM_A|Left |Right|LOWER|                                     |RAISE|Down | Up  | Alt | Ctrl |
 *   `------------------------------'                                     `------------------------------'
 *                                   ,-----------.           ,-----------.
 *                                   |Home | End |           |PgDn |PgUp |
 *                             ,-----|-----|-----|           |-----+-----+-----.
 *                             |     |     |Lock |           |A_OFF|     |     |
 *                             |BkSpc|LGUI |-----|           |-----|Enter|Space|
 *                             |     |     |RAISE|           |LOWER|     |     |
 *                             `-----------------'           `-----------------'
 */
[_DVORAK] = LAYOUT_ergodox_pretty_wrapper(
  KC_ESC,   ________________NUMBER_L__________________, KC_GRV, KC_EQUAL, ________________NUMBER_R__________________, KC_BSLS,
  KC_TAB,   ________________DVORAK_L1_________________, KC_DEL, TG(_NUM), ________________DVORAK_R1_________________, KC_SLASH,
  KC_LCTL,  ________________DVORAK_L2_________________,                   ________________DVORAK_R2_________________, KC_MINUS,
  KC_LSFT,  ________________DVORAK_L3_________________, KC_LBRC, KC_RBRC, ________________DVORAK_R3_________________, KC_RSFT,
  ________________DOX_L4____________________,                                      ________________DOX_R4____________________,
                                            ________________DOXTHUMBS_________________
),

/* Keymap 2: Basic Colemak layer
 *
 * ,---------------------------------------------.           ,--------------------------------------------.
 * |  Esc   |  1  |  2  |  3  |  4  |  5  |  `   |           |  \   |  6  |  7  |  8  |  9  |  0  |   =    |
 * |--------+-----+-----+-----+-----+------------|           |------+-----+-----+-----+-----+-----+--------|
 * |  Tab   |  Q  |  W  |  F  |  P  |  G  | Del  |           | NUM  |  J  |  L  |  U  |  Y  |  ;  |   -    |
 * |--------+-----+-----+-----+-----+-----|      |           |      |-----+-----+-----+-----+-----+--------|
 * |  Ctrl  |  A  |  R  |  S  |  T  |  D  |------|           |------|  H  |  N  |  E  |  I  |  O  |   '    |
 * |--------+-----+-----+-----+-----+-----|  [{  |           |  ]}  |-----+-----+-----+-----+-----+--------|
 * | LShift |  Z  |  X  |  C  |  V  |  B  |      |           |      |  K  |  M  |  ,  |  .  |  /  | RShift |
 * `--------+-----+-----+-----+-----+------------'           `------------+-----+-----+-----+-----+--------'
 *   |OSM_C |OSM_A|Left |Right|LOWER|                                     |RAISE|Down | Up  | Alt | Ctrl |
 *   `------------------------------'                                     `------------------------------'
 *                                   ,-----------.           ,-----------.
 *                                   |Home | End |           |PgDn |PgUp |
 *                             ,-----|-----|-----|           |-----+-----+-----.
 *                             |     |     |Lock |           |A_OFF|     |     |
 *                             |BkSpc|LGUI |-----|           |-----|Enter|Space|
 *                             |     |     |RAISE|           |LOWER|     |     |
 *                             `-----------------'           `-----------------'
 */
[_COLEMAK] = LAYOUT_ergodox_pretty_wrapper(
  KC_ESC,   ________________NUMBER_L__________________, KC_GRV, KC_BSLS,  ________________NUMBER_R__________________, KC_EQUAL,
  KC_TAB,   ________________COLEMAK_L1________________, KC_DEL, TG(_NUM), ________________COLEMAK_R1________________, KC_MINUS,
  KC_LCTL,  ________________COLEMAK_L2________________,                   ________________COLEMAK_R2________________, KC_QUOTE,
  KC_LSFT,  ________________COLEMAK_L3________________, KC_LBRC, KC_RBRC, ________________COLEMAK_R3________________, KC_RSFT,
  ________________DOX_L4____________________,                                      ________________DOX_R4____________________,
                                            ________________DOXTHUMBS_________________
),

/* Keymap 3: Basic Workman layer
 *
 * ,---------------------------------------------.           ,--------------------------------------------.
 * |  Esc   |  1  |  2  |  3  |  4  |  5  |  -   |           |  \   |  6  |  7  |  8  |  9  |  0  |   =    |
 * |--------+-----+-----+-----+-----+------------|           |------+-----+-----+-----+-----+-----+--------|
 * |  Tab   |  Q  |  D  |  R  |  W  |  B  | Del  |           | NUM  |  J  |  F  |  U  |  P  |  ;  |  BSPC  |
 * |--------+-----+-----+-----+-----+-----|      |           |      |-----+-----+-----+-----+-----+--------|
 * |  Ctrl  |  A  |  S  |  H  |  T  |  G  |------|           |------|  Y  |  N  |  E  |  O  |  I  |   '"   |
 * |--------+-----+-----+-----+-----+-----|  [{  |           |  ]}  |-----+-----+-----+-----+-----+--------|
 * | LShift |  Z  |  X  |  M  |  C  |  V  |      |           |      |  K  |  L  |  ,  |  .  |  /  | RShift |
 * `--------+-----+-----+-----+-----+------------'           `------------+-----+-----+-----+-----+--------'
 *   |OSM_C |OSM_A|Left |Right|LOWER|                                     |RAISE|Down | Up  | Alt | Ctrl |
 *   `------------------------------'                                     `------------------------------'
 *                                   ,-----------.           ,-----------.
 *                                   |Home | End |           |PgDn |PgUp |
 *                             ,-----|-----|-----|           |-----+-----+-----.
 *                             |     |     |Lock |           |A_OFF|     |     |
 *                             |BkSpc|LGUI |-----|           |-----|Enter|Space|
 *                             |     |     |RAISE|           |LOWER|     |     |
 *                             `-----------------'           `-----------------'
 */
[_WORKMAN] = LAYOUT_ergodox_pretty_wrapper(
  KC_ESC,   ________________NUMBER_L__________________, KC_MINS, KC_BSLS, ________________NUMBER_R__________________, KC_EQUAL,
  KC_TAB,   ________________WORKMAN_L1________________, KC_DEL, TG(_NUM), ________________WORKMAN_R1________________, KC_BSPACE,
  KC_LCTL,  ________________WORKMAN_L2________________,                   ________________WORKMAN_R2________________, KC_QUOTE,
  KC_LSFT,  ________________WORKMAN_L3________________, KC_LBRC, KC_RBRC, ________________WORKMAN_R3________________, KC_RSFT,
  ________________DOX_L4____________________,                                      ________________DOX_R4____________________,
                                            ________________DOXTHUMBS_________________
),

/* Keymap 4: Lower
 *
 * ,---------------------------------------------------.           ,--------------------------------------------------.
 * |         |  F1  |  F2  |  F3  |  F4  |  F5  | F11  |           | F12  |  F6  |  F7  |  F8  |  F9  | F10  |        |
 * |---------+------+------+------+------+------+------|           |------+------+------+------+------+------+--------|
 * |         |  !   |  @   |  #   |  $   |  %   |      |           |      |  ^   |  &   |  *   |  (   |  )   |        |
 * |---------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |         |  1   |  2   |  3   |  4   |  5   |------|           |------|  6   |  7   |  8   |  9   |  0   |        |
 * |---------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |         |  `   |  '   |  \   |  /   |  -   |      |           |      |  =   |  [   |  ]   |  {   |  }   |        |
 * `---------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   |       |      |      |      |      |                                       |      |      |      |      |      |
 *   `-----------------------------------'                                       `----------------------------------'
 *                                       ,-------------.           ,-------------.
 *                                       |      |      |           |      |      |
 *                                ,------|------|------|           |------+------+------.
 *                                |      |      |      |           |      |      |      |
 *                                |      |      |------|           |------|      |      |
 *                                |      |      |      |           |      |      |      |
 *                                `--------------------'           `--------------------'
 */
[_LOWER] = LAYOUT_ergodox_pretty_wrapper(
  _______, ________________FUNC_L____________________, KC_F11,   KC_F12, ________________FUNC_R____________________, _______,
  _______, ________________LOWER_L1__________________, _______, _______, ________________LOWER_R1__________________, _______,
  _______, ________________LOWER_L2__________________,                   ________________LOWER_R2__________________, _______,
  _______, ________________LOWER_L3__________________, _______, _______, ________________LOWER_R3__________________, _______,
  _______, _______, _______, _______, _______,                                   _______, _______, _______, _______, _______,
                                            ________________DOXTHUMBS_________________
),

/* Keymap 5: Raise
 *
 * ,---------------------------------------------------.           ,--------------------------------------------------.
 * |         |  F1  |  F2  |  F3  |  F4  |  F5  | F11  |           | F12  |  F6  |  F7  |  F8  |  F9  | F10  |        |
 * |---------+------+------+------+------+------+------|           |------+------+------+------+------+------+--------|
 * |         |PrScr | Back |  Up  | Fwd  | App  |      |           |      |Insert|C-PgUp| PgUp |C-PgDn|GUI-L |        |
 * |---------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |         |ScrLk | Left | Down |Right |CapsLk|------|           |------|Delete| Home | PgDn | End  |KVMSW1|        |
 * |---------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |         |Pause |      |      |      |      |      |           |      |      |      |      |      |KVMSW2|        |
 * `---------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   |       |      |      |      |      |                                       |      |      |      |      |      |
 *   `-----------------------------------'                                       `----------------------------------'
 *                                       ,-------------.           ,-------------.
 *                                       |      |      |           |      |      |
 *                                ,------|------|------|           |------+------+------.
 *                                |      |      |      |           |      |      |      |
 *                                |      |      |------|           |------|      |      |
 *                                |      |      |      |           |      |      |      |
 *                                `--------------------'           `--------------------'
 */
[_RAISE] = LAYOUT_ergodox_pretty_wrapper(
  _______, ________________FUNC_L____________________, KC_F11,   KC_F12, ________________FUNC_R____________________, _______,
  _______, ________________RAISE_L1__________________, _______, _______, ________________RAISE_R1__________________, _______,
  _______, ________________RAISE_L2__________________,                   ________________RAISE_R2__________________, _______,
  _______, ________________RAISE_L3__________________, _______, _______, ________________RAISE_R3__________________, _______,
  _______, _______, _______, _______, _______,                                   _______, _______, _______, _______, _______,
                                            ________________DOXTHUMBS_________________
),

/* Keymap 6: Adjust
 *
 * ,--------------------------------------------------.           ,--------------------------------------------------.
 * |        |      |      |      |      |      |      |           |      |      |      |      |      |      |        |
 * |--------+------+------+------+------+-------------|           |------+------+------+------+------+------+--------|
 * |        |RGBHUI|RGBSAI|RGBTOG|RGBVAI|RGBMOD|      |           |      |RESET |      | EPRM |      | VRSN |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |        |BLSTEP|BL_DEC|BL_TOG|BL_INC|BLBRTG|------|           |------|      |QWERTY|DVORAK|COLEMK|WRKMAN|        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |        |RGBHUD|RGBSAD|RGBSPD|RGBVAD|RGBRMO|      |           |      | MUTE |VOL_DN|VOL_UP| PLAY | NEXT |        |
 * `--------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   |      |      |      |      |      |                                       |      |      |      |      |      |
 *   `----------------------------------'                                       `----------------------------------'
 *                                      ,-------------.           ,-------------.
 *                                      |      |      |           |      |      |
 *                               ,------|------|------|           |------+------+------.
 *                               |      |      |      |           |      |      |      |
 *                               |      |      |------|           |------|      |      |
 *                               |      |      |      |           |      |      |      |
 *                               `--------------------'           `--------------------'
 */
[_ADJUST] = LAYOUT_ergodox_pretty_wrapper(
  _______, ________________BLANK_____________________, _______, _______, ________________BLANK_____________________, _______,
  _______, ________________ADJUST_L1_________________, _______, _______, ________________ADJUST_R1_________________, _______,
  _______, ________________ADJUST_L2_________________,                   ________________ADJUST_R2_________________, _______,
  _______, ________________ADJUST_L3_________________, _______, _______, ________________ADJUST_R3_________________, _______,
  _______, _______, _______, _______, _______,                                   _______, _______, _______, _______, _______,
                                            ________________DOXTHUMBS_________________
),

/* Keymap 7: GAME
 *
 * ,--------------------------------------------------.           ,--------------------------------------------------.
 * |  Esc   |  `   |  1   |  2   |  3   |  4   |  5   |           |      |      |      |      |      |      |        |
 * |--------+------+------+------+------+-------------|           |------+------+------+------+------+------+--------|
 * |   F1   | Tab  |  Q   |  W   |  E   |  R   |  T   |           |      |      |      |      |      |      |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |   F2   |  G   |  A   |  S   |  D   |  F   |------|           |------|      |      |      |      |      |        |
 * |--------+------+------+------+------+------| Alt  |           |      |------+------+------+------+------+--------|
 * |   F3   |Shift |  Z   |  X   |  C   |  V   |      |           |      |      |      |      |      |      |        |
 * `--------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   |  F4  |  P   |  Y   |  I   |LOWER |                                       |      |      |      |      |      |
 *   `----------------------------------'                                       `----------------------------------'
 *                                      ,-------------.           ,-------------.
 *                                      | Ctrl |  B   |           |      |      |
 *                               ,------|------|------|           |------+------+------.
 *                               |      |      |  O   |           |      |      |      |
 *                               |Space |  H   |------|           |------|GMCHAT|      |
 *                               |      |      |  M   |           |      |      |      |
 *                               `--------------------'           `--------------------'
 */
[_GAMEPAD] = LAYOUT_ergodox_wrapper(
  // Left hand
  _______________________GAMEPAD_L0_______________________, 
  _______________________GAMEPAD_L1_______________________, 
  _______________________GAMEPAD_L2_______________________, 
  _______________________GAMEPAD_L3_______________________, 
  _______________________GAMEPAD_L4_______________________,
                                _____GAMEPAD_THUMB_L______,
  // Right hand
  _______, ________________BLANK_____________________, _______,
  _______, ________________BLANK_____________________, _______,
           ________________BLANK_____________________, _______,
  _______, ________________BLANK_____________________, _______,
                   _______, _______, _______, _______, _______,
  _______, _______,
  _______,
  _______, _______, _______
),

/* Keymap 8: NUMPAD
 *
 * ,--------------------------------------------------.           ,--------------------------------------------------.
 * |        |      |      |      |      |      |      |           |      |      |NumLk |  /   |  *   |  -   |        |
 * |--------+------+------+------+------+------+------|           |------+------+------+------+------+------+--------|
 * |        |      |      |      |      |      |      |           |      |      |  7   |  8   |  9   |  +   |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |        |      |      |      |      |      |------|           |------|      |  4   |  5   |  6   |  +   |        |
 * |--------+------+------+------+------+------|      |           |      |------+------+------+------+------+--------|
 * |        |      |      |      |      |      |      |           |      |      |  1   |  2   |  3   |Enter |        |
 * `--------+------+------+------+------+-------------'           `-------------+------+------+------+------+--------'
 *   |      |      |      |      |      |                                       |  0   |  0   |  .   |Enter |      |
 *   `----------------------------------'                                       `----------------------------------'
 *                                      ,-------------.           ,-------------.
 *                                      |      |      |           |      |      |
 *                               ,------|------|------|           |------+------+------.
 *                               |      |      |      |           |      |      |      |
 *                               |      |      |------|           |------|      |      |
 *                               |      |      |      |           |      |      |      |
 *                               `--------------------'           `--------------------'
 */
[_NUM] = LAYOUT_ergodox_pretty_wrapper(
  _______, ________________BLANK_____________________, _______, _______, ________________NUMPAD_R0_________________, _______,
  _______, ________________BLANK_____________________, _______, _______, ________________NUMPAD_R1_________________, _______,
  _______, ________________BLANK_____________________,                   ________________NUMPAD_R2_________________, _______,
  _______, ________________BLANK_____________________, _______, _______, ________________NUMPAD_R3_________________, _______,
  _______, _______, _______, _______, _______,                                    ________________NUMPAD_R4_________________,
                                            ________________DOXTHUMBS_________________
),

};
// clang-format on

layer_state_t layer_state_set_keymap(layer_state_t state) {
    uint8_t layer = biton32(state);

    ergodox_board_led_off();
    ergodox_led_lower_off();
    ergodox_led_raise_off();
    ergodox_led_adjust_off();

    switch (layer) {
        case _LOWER:
            ergodox_led_lower_on();
            break;
        case _RAISE:
            ergodox_led_raise_on();
            break;
        case _ADJUST:
            ergodox_led_adjust_on();
            break;
    }

    return state;
}
